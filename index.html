<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OceanGuard // Monitoring System</title>

  <script src="https://cdn.jsdelivr.net/npm/canvas-gauges@2.1.7/gauge.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg-deep: #0f172a;
      --bg-card: #1e293b;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --accent-depth: #0ea5e9;   /* Light Blue */
      --accent-press: #f43f5e;   /* Rose/Red */
      --accent-oxy: #10b981;     /* Emerald */
      --border-color: rgba(148, 163, 184, 0.1);
    }

    body {
      background-color: var(--bg-deep);
      /* Subtle grid background */
      background-image: 
        linear-gradient(rgba(15, 23, 42, 0.9), rgba(15, 23, 42, 0.9)),
        url("https://www.transparenttextures.com/patterns/cubes.png");
      font-family: 'Inter', sans-serif;
      color: var(--text-primary);
      margin: 0;
      padding: 20px;
      min-height: 100vh;
    }

    /* --- Header --- */
    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border-color);
    }

    h2 {
      margin: 0;
      font-size: 1.5rem;
      letter-spacing: 1px;
      text-transform: uppercase;
    }
    
    .status-badge {
      background: rgba(16, 185, 129, 0.2);
      color: #34d399;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-family: 'JetBrains Mono', monospace;
      border: 1px solid rgba(16, 185, 129, 0.3);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .status-dot {
      width: 8px;
      height: 8px;
      background-color: #34d399;
      border-radius: 50%;
      box-shadow: 0 0 8px #34d399;
      animation: pulse 2s infinite;
    }

    /* --- Layout Grid --- */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    /* --- Cards --- */
    .card {
      background: rgba(30, 41, 59, 0.7);
      backdrop-filter: blur(10px);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      border-color: rgba(255, 255, 255, 0.1);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 10px;
    }

    .card-title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--text-secondary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .live-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-primary);
    }

    /* --- Visual Containers --- */
    .gauge-wrapper {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 10px 0;
      min-height: 220px;
    }

    .chart-wrapper {
      position: relative;
      height: 200px;
      width: 100%;
    }

    .card-desc {
      margin-top: 15px;
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    /* --- Info Panel --- */
    .info-panel {
      background: rgba(15, 23, 42, 0.6);
      border: 1px dashed var(--border-color);
      border-radius: 12px;
      padding: 25px;
      margin-top: 40px;
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    .info-item h4 {
      color: var(--accent-depth);
      margin: 0 0 8px 0;
      font-size: 0.95rem;
    }
    
    .info-item p {
      margin: 0;
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* --- Animations --- */
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    /* Responsive adjustments */
    @media (max-width: 768px) {
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      header {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }
    }
  </style>
</head>
<body>

<header>
  <div>
    <h2>OceanGuard <span style="font-weight:300; color:var(--text-secondary)">// Simulator</span></h2>
    <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">Sistem Pemantauan Kondisi Laut Real-time</div>
  </div>
  <div class="status-badge">
    <div class="status-dot"></div>
    SYSTEM ONLINE
  </div>
</header>

<div class="dashboard-grid">
  
  <div class="card" style="border-top: 3px solid var(--accent-depth)">
    <div class="card-header">
      <div class="card-title">Kedalaman (Depth)</div>
      <div class="live-value" style="color: var(--accent-depth)">SENSOR-01</div>
    </div>
    <div class="gauge-wrapper">
      <canvas id="gaugeDepth" width="120" height="300"
        data-type="linear-gauge"
        data-min-value="0"
        data-max-value="200"
        data-major-ticks="0,50,100,150,200"
        data-minor-ticks="5"
        data-units="m"
        data-bar-begin-circle="false"
        data-tick-side="right"
        data-number-side="right"
        data-needle-side="right"
        data-bar-width="10"
        data-color-bar-progress="#0ea5e9"
        data-color-plate="transparent"
        data-color-major-ticks="#f1f5f9"
        data-color-minor-ticks="#94a3b8"
        data-color-numbers="#f1f5f9"
        data-color-units="#94a3b8"
        data-border-shadow-width="0"
        data-borders="false"
        data-needle-type="arrow"
        data-needle-width="3"
        data-animation-duration="1500"
        data-animation-rule="linear"
      ></canvas>
    </div>
    <div class="card-desc">
      Jarak vertikal ke dasar laut. Mempengaruhi tekanan secara langsung.
    </div>
  </div>

  <div class="card" style="border-top: 3px solid var(--accent-press)">
    <div class="card-header">
      <div class="card-title">Tekanan (Pressure)</div>
      <div class="live-value" style="color: var(--accent-press)">SENSOR-02</div>
    </div>
    <div class="gauge-wrapper">
      <canvas id="gaugePressure" width="220" height="220"
        data-type="radial-gauge"
        data-min-value="0"
        data-max-value="30"
        data-major-ticks="0,5,10,15,20,25,30"
        data-units="atm"
        data-title="PRESSURE"
        data-color-plate="transparent"
        data-color-major-ticks="#f1f5f9"
        data-color-minor-ticks="#94a3b8"
        data-color-numbers="#f1f5f9"
        data-color-title="#fff"
        data-color-units="#94a3b8"
        data-border-shadow-width="0"
        data-borders="false"
        data-needle-type="line"
        data-needle-width="2"
        data-needle-circle-size="7"
        data-color-needle="#f43f5e"
        data-color-needle-end="#f43f5e"
        data-color-bar-progress="#f43f5e"
        data-value-box="true"
        data-font-value="JetBrains Mono"
        data-color-value-box-rect="#1e293b"
        data-color-value-box-rect-end="#1e293b"
        data-color-value-text="#fff"
      ></canvas>
    </div>
    <div class="card-desc">
      Tekanan hidrostatik total. Meningkat ±1 atm setiap kedalaman 10m.
    </div>
  </div>

  <div class="card" style="border-top: 3px solid var(--accent-oxy)">
    <div class="card-header">
      <div class="card-title">Oksigen (DO)</div>
      <div class="live-value" style="color: var(--accent-oxy)">SENSOR-03</div>
    </div>
    <div class="gauge-wrapper">
      <canvas id="gaugeOksigen" width="220" height="220"
        data-type="radial-gauge"
        data-min-value="0"
        data-max-value="12"
        data-major-ticks="0,2,4,6,8,10,12"
        data-units="mg/L"
        data-title="OXYGEN"
        data-color-plate="transparent"
        data-color-major-ticks="#f1f5f9"
        data-color-minor-ticks="#94a3b8"
        data-color-numbers="#f1f5f9"
        data-color-title="#fff"
        data-color-units="#94a3b8"
        data-border-shadow-width="0"
        data-borders="false"
        data-needle-type="line"
        data-needle-width="2"
        data-needle-circle-size="7"
        data-color-needle="#10b981"
        data-color-needle-end="#10b981"
        data-color-bar-progress="#10b981"
        data-value-box="true"
        data-font-value="JetBrains Mono"
        data-color-value-box-rect="#1e293b"
        data-color-value-box-rect-end="#1e293b"
        data-color-value-text="#fff"
      ></canvas>
    </div>
    <div class="card-desc">
      Konsentrasi oksigen terlarut. Menurun seiring bertambahnya kedalaman.
    </div>
  </div>

</div>

<div class="dashboard-grid">
  
  <div class="card">
    <div class="card-header">
      <div class="card-title">Riwayat Kedalaman</div>
      <span style="font-size:12px; color:var(--text-secondary)">Last 60s</span>
    </div>
    <div class="chart-wrapper">
      <canvas id="chartDepth"></canvas>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-title">Riwayat Tekanan</div>
      <span style="font-size:12px; color:var(--text-secondary)">Last 60s</span>
    </div>
    <div class="chart-wrapper">
      <canvas id="chartPressure"></canvas>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div class="card-title">Riwayat Oksigen</div>
      <span style="font-size:12px; color:var(--text-secondary)">Last 60s</span>
    </div>
    <div class="chart-wrapper">
      <canvas id="chartOksigen"></canvas>
    </div>
  </div>

</div>

<div class="info-panel">
  <div class="card-header" style="border:none; margin-bottom:20px;">
    <div class="card-title" style="color:var(--text-primary)">Korelasi Parameter</div>
  </div>
  <div class="info-grid">
    <div class="info-item">
      <h4>Kedalaman vs Tekanan</h4>
      <p>Hubungan linear positif. Tekanan (P) meningkat seiring kedalaman (h). Rumus pendekatan: <code>P ≈ 1 + (h/10)</code>.</p>
    </div>
    <div class="info-item">
      <h4>Kedalaman vs Oksigen</h4>
      <p>Hubungan invers. Di kedalaman yang lebih besar, fotosintesis berkurang drastis, menyebabkan kadar oksigen menurun (Hypoxia).</p>
    </div>
    <div class="info-item">
      <h4>Ambang Batas Biologis</h4>
      <p>Kadar oksigen di bawah <strong>3 mg/L</strong> dikategorikan sebagai kondisi berbahaya bagi sebagian besar organisme laut pelagis.</p>
    </div>
  </div>
</div>

<script>
window.onload = function () {

  // Warna Tema JS (harus sama dengan CSS)
  const colors = {
    depth: '#0ea5e9',
    pressure: '#f43f5e',
    oxygen: '#10b981',
    grid: 'rgba(148, 163, 184, 0.1)',
    text: '#94a3b8'
  };

  // GAUGES references
  let gDepth    = document.gauges.get('gaugeDepth');
  let gPressure = document.gauges.get('gaugePressure');
  let gOxygen   = document.gauges.get('gaugeOksigen');

  // CHART CREATOR FUNCTION (Updated for Dark Mode)
  function createChart(id, min, max, color, label) {
    const ctx = document.getElementById(id).getContext("2d");
    
    // Gradient Fill
    let gradient = ctx.createLinearGradient(0, 0, 0, 200);
    gradient.addColorStop(0, color + "80"); // color with alpha
    gradient.addColorStop(1, color + "05"); // fade out

    return new Chart(ctx, {
      type: 'line',
      data: {
        labels: Array(20).fill(""),
        datasets: [{
          label: label,
          data: Array(20).fill(min),
          borderWidth: 2,
          tension: 0.4, // Lebih smooth kurvanya
          borderColor: color,
          backgroundColor: gradient,
          pointRadius: 0, // Hilangkan titik agar bersih
          pointHoverRadius: 4,
          fill: true
        }]
      },
      options: { 
        animation: false, 
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { display: false },
          tooltip: {
            mode: 'index',
            intersect: false,
            backgroundColor: 'rgba(15, 23, 42, 0.9)',
            titleColor: '#fff',
            bodyColor: '#fff',
            borderColor: 'rgba(255,255,255,0.1)',
            borderWidth: 1
          }
        },
        scales: { 
          y: { 
            min: min, 
            max: max,
            grid: { color: colors.grid, borderDash: [5, 5] },
            ticks: { color: colors.text, font: { family: 'JetBrains Mono', size: 10 } },
            border: { display: false }
          },
          x: {
            grid: { display: false },
            ticks: { display: false }
          }
        },
        interaction: {
          mode: 'nearest',
          axis: 'x',
          intersect: false
        }
      }
    });
  }
  
  let chartDepth    = createChart("chartDepth", 0, 200, colors.depth, "Kedalaman (m)");
  let chartPressure = createChart("chartPressure", 0, 30, colors.pressure, "Tekanan (atm)");
  let chartOxygen   = createChart("chartOksigen", 0, 12, colors.oxygen, "Oksigen (mg/L)");

  // SIMULASI LOOP (Updated Logic)
  let time = 0;
  
  setInterval(() => {
    // Simulasi Gerakan Gelombang Sine Wave yang lebih natural
    time += 0.1;
    
    // Kedalaman bervariasi random tapi smooth
    let noise = (Math.random() - 0.5) * 20;
    let baseDepth = 100 + (Math.sin(time) * 50); // Bergerak antara 50m - 150m
    let depth = baseDepth + noise;
    if(depth < 0) depth = 0;
    if(depth > 200) depth = 200;

    // Fisika Sederhana
    let pressure = 1 + (depth / 10); // 1 atm udara + air
    
    // Oksigen (Makin dalam makin sedikit, plus noise)
    // Surface (0m) = ~8-10mg/L, Deep (200m) = ~2-4mg/L
    let oxyBase = 9 - (depth * 0.035); 
    let oxygen = oxyBase + (Math.random() * 0.5);
    if (oxygen < 1) oxygen = 1;

    // Update Gauges
    gDepth.value    = depth;
    gPressure.value = pressure;
    gOxygen.value   = oxygen;

    // Update Charts
    function pushData(chart, val) {
      chart.data.datasets[0].data.shift();
      chart.data.datasets[0].data.push(val);
      chart.update('none'); // mode 'none' performance optimization
    }

    pushData(chartDepth, depth);
    pushData(chartPressure, pressure);
    pushData(chartOxygen, oxygen);

  }, 2000); // Update setiap 2 detik agar animasi gauge sempat selesai

};
</script>

</body>
</html>
